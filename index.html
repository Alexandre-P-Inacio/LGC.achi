<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com https://cdn.jsdelivr.net https://*.azureedge.net https://*.supabase.co; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; img-src 'self' data:; font-src 'self' https://cdnjs.cloudflare.com; connect-src 'self' https://*.supabase.co https://pwsgmskiamkpzgtlaikm.supabase.co;">
    <title>Architecture Portfolio</title>
    <link rel="icon" type="image/png" href="assets/logo(2).png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="client-dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Load Supabase first -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://pwsgmskiamkpzgtlaikm.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB3c2dtc2tpYW1rcHpndGxhaWttIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzNzM5NzIsImV4cCI6MjA1OTk0OTk3Mn0.oYGnYIpOUteNha2V1EoyhgxDA1XFfzxTjY8jAbSyLmI';
        window.supabase = supabase.createClient(supabaseUrl, supabaseKey);
        console.log('Supabase initialized in index.html');
    </script>
    
    <!-- Then load other scripts -->
    <script src="auth.js" defer></script>
    <script src="animation.js" defer></script>
    <script src="navigation.js"></script>
    <script src="client-dashboard.js" defer></script>
    
    <style>
        /* Fixed Chat Button Styles */
        .fixed-chat-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            background-color: #333;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .fixed-chat-button:hover {
            background-color: #000000c9;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .fixed-chat-button i {
            font-size: 32px;
        }
        
        @media (max-width: 768px) {
            .fixed-chat-button {
                width: 65px;
                height: 65px;
                bottom: 20px;
                right: 20px;
            }
            
            .fixed-chat-button i {
                font-size: 26px;
            }
        }
        
        /* Enhanced Featured Projects Styles */
        #projects, #featured-projects {
            padding: 5rem 0 6rem;
            background-color: #f8f9fa;
        }
        
        #projects h2, #featured-projects h2 {
            text-align: center;
            font-size: 2.8rem;
            margin-bottom: 3.5rem;
            position: relative;
            color: #333;
            font-weight: 700;
        }
        
        #projects h2:after, #featured-projects h2:after {
            content: '';
            display: block;
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #333, #828282);
            margin: 15px auto 0;
            border-radius: 2px;
        }
        
        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2.5rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .project-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .project-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .project-image {
            height: 240px;
            background-size: cover;
            background-position: center;
            position: relative;
            overflow: hidden;
        }
        
        .project-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 70%, rgba(0, 0, 0, 0.4));
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .project-card:hover .project-image::before {
            opacity: 1;
        }
        
        .project-card h3 {
            font-size: 1.4rem;
            margin: 1.5rem 1.5rem 0.5rem;
            color: #333;
            font-weight: 600;
        }
        
        .project-card p {
            color: #666;
            margin: 0 1.5rem 1.5rem;
            font-size: 1rem;
        }
        
        .view-project-btn {
            margin: auto 1.5rem 1.5rem;
            padding: 0.8rem 1.5rem;
            background-color: #333;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            text-align: center;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            display: block;
        }
        
        .view-project-btn:hover {
            background-color: #000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .no-projects, .error-message {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            color: #666;
            font-size: 1.1rem;
        }
        
        .error-message i {
            color: #dc3545;
            font-size: 2rem;
            margin-bottom: 1rem;
            display: block;
        /* Carousel styling */
        .carousel-section {
            max-width: 90%;
            margin: 0 auto;
            padding: 20px 0;
            position: relative;
        }
        
        .carousel-container {
            display: flex;
            align-items: center;
            position: relative;
            padding: 0 90px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .carousel-mask {
            position: relative;
            overflow: hidden;
            width: 100%;
        }
        
        .project-carousel {
            display: flex;
            transition: transform 0.5s ease;
            padding: 10px 0;
        }
        
        .project-card {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            background-color: white;
            border-radius: 0.5rem;
            margin: 0 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }
        
        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        .project-image {
            width: 100%;
            height: 280px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: transform 0.5s ease;
        }
        
        .project-card:hover .project-image {
            transform: scale(1.05);
        }
        
        .project-card h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 1.8rem 1.8rem 0.6rem;
            color: #333;
        }
        
        .project-card p {
            margin: 0 1.8rem 1.8rem;
            color: #666;
            flex-grow: 1;
            font-size: 1.1rem;
        }
        
        .view-project-btn {
            display: block;
            background-color: var(--primary-color, #333);
            color: white;
            text-align: center;
            padding: 0.8rem 1.5rem;
            margin: auto 1.5rem 1.5rem;
            text-decoration: none;
            border-radius: 4px;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .view-project-btn:hover {
            background-color: var(--accent-color, #555);
        }
        
        .carousel-nav-button {
            background-color: white;
            color: black;
            border: 1px solid #E5E7EB;
            border-radius: 9999px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: absolute;
            z-index: 10;
        }
        
        .carousel-nav-button.prev-button {
            left: 0;
        }
        
        .carousel-nav-button.next-button {
            right: 0;
        }
        
        .carousel-nav-button:hover {
            background-color: #F3F4F6;
        }
        
        .carousel-nav-button:focus {
            outline: none;
            ring: 2px;
            ring-color: #4F46E5;
        }
        
        .carousel-nav-button.hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            #projects, #featured-projects {
                padding: 3rem 0 4rem;
            }
            
            #projects h2, #featured-projects h2 {
                font-size: 2.4rem;
                margin-bottom: 2.5rem;
            }
            
            .carousel-container {
                padding: 0 70px;
            }
            
            .carousel-nav-button {
                width: 32px;
                height: 32px;
            }
            
            .project-image {
                height: 220px;
            }
            
            .project-card h3 {
                font-size: 1.3rem;
                margin: 1.4rem 1.4rem 0.5rem;
            }
            
            .project-card p {
                margin: 0 1.4rem 1.4rem;
                font-size: 1rem;
            }
            
            .view-project-btn {
                margin: auto 1.2rem 1.2rem;
                padding: 0.7rem 1.2rem;
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 640px) {
            .carousel-container {
                padding: 0 55px;
            }
            
            .carousel-nav-button {
                width: 28px;
                height: 28px;
            }
            
            .project-card {
                margin: 0 5px;
            }
            
            .project-image {
                height: 200px;
            }
        }
        
        /* Loading & Error States */
        .loading-spinner {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            grid-column: 1 / -1;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #333;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .no-projects, .error-message {
            width: 100%;
            text-align: center;
            padding: 3rem;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            color: #666;
            font-size: 1.1rem;
        }
        
        .error-message i {
            color: #dc3545;
            font-size: 2rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .carousel-container {
                max-width: 1100px;
            }
            
            .project-image {
                height: 250px;
            }
            
            .project-card h3 {
                font-size: 1.2rem;
                margin: 1.2rem 1.2rem 0.4rem;
            }
            
            .project-card p {
                margin: 0 1.2rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .view-project-btn {
                margin: auto 1.2rem 1.2rem;
                padding: 0.7rem 1.2rem;
                font-size: 0.8rem;
            }
        }
        
        /* Slideshow navigation buttons */
        .slide-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.3s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .slide-nav-btn:hover {
            opacity: 1;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .prev-btn {
            left: 20px;
        }
        
        .next-btn {
            right: 20px;
        }
        
        @media (max-width: 768px) {
            .slide-nav-btn {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            
            .prev-btn {
                left: 10px;
            }
            
            .next-btn {
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <header>   <script src="navigation.js"></script>    </header>
    <main>
        <section id="hero">
            <div class="hero-slideshow" id="hero-slideshow">
                <div class="hero-slide active"></div>
                <div class="hero-slide"></div>
                <div class="hero-slide"></div>
                <div class="hero-slide"></div>
                <div class="hero-slide"></div>
                <div class="hero-slide"></div>
            </div>
            
            <!-- Add previous and next buttons -->
            <button class="slide-nav-btn prev-btn" id="prev-slide">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slide-nav-btn next-btn" id="next-slide">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <div class="slideshow-dots">
                <div class="slideshow-dot active" data-slide="0"></div>
                <div class="slideshow-dot" data-slide="1"></div>
                <div class="slideshow-dot" data-slide="2"></div>
                <div class="slideshow-dot" data-slide="3"></div>
                <div class="slideshow-dot" data-slide="4"></div>
                <div class="slideshow-dot" data-slide="5"></div>
            </div>
            <div class="hero-content">
                <h1>Architecture Portfolio</h1>
            </div>
        </section>

        <section id="projects">
            <h2>Featured Projects</h2>
            <div class="project-grid" id="featured-projects-container">
                <!-- Featured projects will be loaded dynamically here -->
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <p>Loading featured projects...</p>
                </div>
            </div>
        </section>

        <section id="about">
            <div class="about-content">
                <h2>About Us</h2>
                <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Optio porro ipsam velit alias modi quasi a dolor beatae culpa est, cupiditate ratione dicta similique, minima ab nisi officia aliquam. Laborum.</p>
            </div>
        </section>
    </main>

    <!-- Client Dashboard Popup -->
    <div id="client-dashboard-overlay" class="dashboard-overlay">
        <div class="dashboard-popup">
            <div class="dashboard-popup-header">
                <h2>Practices</h2>
                <button class="close-dashboard" onclick="closeDashboard()"><i class="fas fa-times"></i></button>
            </div>
            <div class="dashboard-popup-content">
                <p>Select a practice area below</p>
                <div class="category-grid">
                    <!-- RF Telecommunications -->
                    <div class="category-card" data-category="rf-telecommunications">
                        <div class="category-overlay">
                            <h3>RF & Telecommunications</h3>
                        </div>
                    </div>
                    
                    <!-- Energy -->
                    <div class="category-card" data-category="energy">
                        <div class="category-overlay">
                            <h3>Energy</h3>
                        </div>
                    </div>
                    
                    <!-- Construction -->
                    <div class="category-card" data-category="construction">
                        <div class="category-overlay">
                            <h3>Construction</h3>
                        </div>
                    </div>
                    
                    <!-- Bank Insurance Office -->
                    <div class="category-card" data-category="banking">
                        <div class="category-overlay">
                            <h3>Banking & Finance</h3>
                        </div>
                    </div>
                    
                    <!-- Sand -->
                    <div class="category-card" data-category="sand">
                        <div class="category-overlay">
                            <h3>Stand</h3>
                        </div>
                    </div>
                    
                    <!-- Oil & Gas -->
                    <div class="category-card" data-category="oil-gas">
                        <div class="category-overlay">
                            <h3>Oil & Gas</h3>
                        </div>
                    </div>
                    
                    <!-- Real Estate -->
                    <div class="category-card" data-category="real-estate">
                        <div class="category-overlay">
                            <h3>Real Estate</h3>
                        </div>
                    </div>
                    
                    <!-- Nuclear -->
                    <div class="category-card" data-category="nuclear">
                        <div class="category-overlay">
                            <h3>Nuclear</h3>
                        </div>
                    </div>
                    
                    <!-- Industrial -->
                    <div class="category-card" data-category="industrial">
                        <div class="category-overlay">
                            <h3>Industrial</h3>
                        </div>
                    </div>
                    
                    <!-- Naval -->
                    <div class="category-card" data-category="naval">
                        <div class="category-overlay">
                            <h3>Naval</h3>
                        </div>
                    </div>
                    
                    <!-- BPO -->
                    <div class="category-card" data-category="bpo">
                        <div class="category-overlay">
                            <h3>GDO</h3>
                        </div>
                    </div>
                    
                    <!-- Automotive -->
                    <div class="category-card" data-category="automotive">
                        <div class="category-overlay">
                            <h3>Automotive</h3>
                        </div>
                    </div>
                    
                    <!-- Aerospace -->
                    <div class="category-card" data-category="aerospace">
                        <div class="category-overlay">
                            <h3>Aerospace</h3>
                        </div>
                    </div>
                    
                    <!-- Chemistry-Pharmaceutical -->
                    <div class="category-card" data-category="chemistry-pharmaceutical">
                        <div class="category-overlay">
                            <h3>Chemistry & Pharmaceutical</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fixed Chat Button -->
    <a href="chat.html" class="fixed-chat-button">
        <i class="fas fa-comments"></i>
        <span class="chat-notification-indicator" id="fixed-chat-notification"></span>
    </a>

    <footer>
        <div class="footer-content">
            <div class="social-links">
                <a href="https://www.instagram.com/lgcarchi/"><i class="fab fa-instagram"></i></a>
                <a href="https://www.facebook.com/profile.php?id=100094347141527"><i class="fab fa-facebook"></i></a>
                <a href="https://twitter.com/ingegneria_lgc"><i class="fab fa-twitter"></i></a>
            </div>
            <p>&copy; 2025 Architecture Portfolio. All rights reserved.</p>
        </div>
    </footer>
    
    <script>
        // Check login status when loading the page
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = localStorage.getItem('currentUser');
            const isAdmin = localStorage.getItem('isAdmin') === 'true';
            console.log('current login status:', currentUser ? 'Logged in as ' + currentUser : 'Not logged in');
            
            // If the user is logged in, make sure the UI is updated
            if (currentUser && typeof updateUserInterface === 'function') {
                updateUserInterface(currentUser);
            }
            
            // Load featured projects
            loadFeaturedProjects();
            
            // Check for chat notifications
            checkChatNotifications();
            
            // Get slide navigation elements
            const prevBtn = document.getElementById('prev-slide');
            const nextBtn = document.getElementById('next-slide');
            
            // Add event listeners for manual navigation
            if (prevBtn && nextBtn) {
                prevBtn.addEventListener('click', function() {
                    navigateSlide(-1);
                    stopAllSlideshowIntervals();
                });
                
                nextBtn.addEventListener('click', function() {
                    navigateSlide(1);
                    stopAllSlideshowIntervals();
                });
                
                // Also stop auto-rotation when clicking on the dot navigation
                document.querySelectorAll('.slideshow-dot').forEach((dot, index) => {
                    dot.addEventListener('click', function() {
                        stopAllSlideshowIntervals();
                    });
                });
            }
        });
        
        // Function to check for unread notifications and show the indicator
        async function checkChatNotifications() {
            try {
                const currentUser = localStorage.getItem('currentUser');
                if (!currentUser || !window.supabase) return;
                
                // Check for unread notifications
                const { data: notifications, error } = await window.supabase
                    .from('notifications')
                    .select('id')
                    .eq('recipient_username', currentUser)
                    .eq('read', false)
                    .limit(1);
                
                if (error) throw error;
                
                // Show notification indicator if there are unread notifications
                const indicator = document.getElementById('fixed-chat-notification');
                if (indicator && notifications && notifications.length > 0) {
                    indicator.classList.add('active');
                }
                
            } catch (error) {
            }
        }
        
        // Function to load featured projects from the database
        async function loadFeaturedProjects() {
            try {
                console.log('Starting to load featured projects...');
                
                // Check if Supabase is initialized
                if (!window.supabase) {
                    console.error('Supabase client not initialized');
                    throw new Error('Database connection not initialized');
                }
                
                console.log('Fetching featured projects from database...');
                
                // Fetch featured projects from the database
                const { data: featuredProjects, error } = await window.supabase
                    .from('projects')
                    .select('*')
                    .eq('is_featured', true)
                    .order('created_at', { ascending: false });
                
                if (error) {
                    console.error('Error fetching featured projects:', error);
                    throw error;
                }
                
                console.log('Featured projects fetched:', featuredProjects);
                
                // Get the container element
                const projectsContainer = document.querySelector('.project-carousel');
                
                // Clear loading indicator
                projectsContainer.innerHTML = '';
                
                if (!featuredProjects || featuredProjects.length === 0) {
                    console.log('No featured projects found');
                    projectsContainer.innerHTML = '<p class="no-projects">No featured projects available at the moment.</p>';
                    return;
                }
                
                console.log('Starting to render featured projects...');
                
                // Map category to image file
                const categoryImageMap = {
                    'rf-telecommunications': 'assets/Telecomunication.jpg',
                    'energy': 'assets/Energy.jpg',
                    'construction': 'assets/Construction.jpg',
                    'banking': 'assets/Bank-insurance-office.jpg',
                    'sand': 'assets/Stands.jpg',
                    'oil-gas': 'assets/Oil-gas.jpg',
                    'real-estate': 'assets/Real-Estate.jpg',
                    'nuclear': 'assets/Nuclear.png',
                    'industrial': 'assets/Industrial.jpg',
                    'naval': 'assets/Naval.jpg',
                    'bpo': 'assets/Bank-insurance-office.jpg',
                    'automotive': 'assets/Automotive.jpg',
                    'aerospace': 'assets/Aerospace.jpg',
                    'chemistry-pharmaceutical': 'assets/Chemistry-Pharmacy.jpg'
                };
                
                // Default featured project images for fallback
                const featuredImages = [
                    'assets/Featured Project 1.png',
                    'assets/Featured Project 2.png',
                    'assets/Featured Project 3.png'
                ];
                
                // Display each featured project
                featuredProjects.forEach((project, index) => {
                    // Format category name for display
                    let categoryDisplay = 'Uncategorized';
                    if (project.category) {
                        categoryDisplay = project.category
                            .split('-')
                            .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                            .join(' ');
                    }
                    
                    // Create project card element
                    const projectCard = document.createElement('div');
                    projectCard.className = 'project-card';
                    
                    // Determine which image to use
                    let imageUrl;
                    
                    if (project.file_url) {
                        // Use project's own file if available and is an image
                        const fileExt = project.file_url.split('.').pop().toLowerCase();
                        const isImage = ['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(fileExt);
                        
                        if (isImage) {
                            imageUrl = project.file_url;
                        } else {
                            // Use category image if file is not an image
                            imageUrl = categoryImageMap[project.category] || featuredImages[index % featuredImages.length];
                        }
                    } else {
                        // No file, use category image
                        imageUrl = categoryImageMap[project.category] || featuredImages[index % featuredImages.length];
                    }
                    
                    // Fill the project card with content
                    projectCard.innerHTML = `
                        <div class="project-image" style="background-image: url('${imageUrl}')"></div>
                        <h3>${project.name || 'Unnamed Project'}</h3>
                        <p>${categoryDisplay}</p>
                    `;
                    
                    // Add the project card to the container
                    projectsContainer.appendChild(projectCard);
                });
                
                console.log('Featured projects rendered successfully');
                
            } catch (error) {
                console.error('Error in loadFeaturedProjects:', error);
                const projectsContainer = document.querySelector('.project-carousel');
                projectsContainer.innerHTML = `
                    <p class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        Failed to load featured projects. Please try again later.<br>
                        <small>Error: ${error.message}</small>
                    </p>
                `;

            }
        }
        
        // Function to navigate slides manually
        function navigateSlide(direction) {
            const slides = document.querySelectorAll('.hero-slide');
            const dots = document.querySelectorAll('.slideshow-dot');
            
            // Find the current active slide
            let activeIndex = 0;
            slides.forEach((slide, index) => {
                if (slide.classList.contains('active')) {
                    activeIndex = index;
                }
            });
            
            // Calculate the new index
            let newIndex = activeIndex + direction;
            
            // Handle wrap-around
            if (newIndex < 0) {
                newIndex = slides.length - 1;
            } else if (newIndex >= slides.length) {
                newIndex = 0;
            }
            
            // Remove active class from current slide and dot
            slides[activeIndex].classList.remove('active');
            dots[activeIndex].classList.remove('active');
            
            // Add active class to new slide and dot
            slides[newIndex].classList.add('active');
            dots[newIndex].classList.add('active');
            
            // Clear any existing automatic rotation interval
            if (window.slideshowInterval) {
                clearInterval(window.slideshowInterval);
                window.slideshowInterval = null;
            }
        }
        
        // Add function to look for and stop any automatic slideshows
        function stopAllSlideshowIntervals() {
            // This will search for and clear any intervals that might be controlling the slideshow
            for (let i = 1; i < 10000; i++) {
                window.clearInterval(i);
            }
            
            // Set a flag to prevent animation.js from restarting autorotation
            window.manualSlideControl = true;
        }
    </script>
</body>
</html>